(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{27:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(5),i=n.n(c),o=n(2),s=n(3),u=n.n(s),l=n(6),d=n(15),h=n(13),j=function(e){var t=Math.round(e-273);return(t>0?"+":"")+t},f=function(){var e=window.location.search||"";if(e){var t=e.split("search="),n=t[t.length-1];return decodeURIComponent(n)}return""},b=function(e){var t=window.location.pathname+"?search="+encodeURIComponent(e);window.history.pushState(null,"",t)},p=(n(27),n(1)),v="Moscow";var O=function(e){var t=e.handleWeatherSearch,n=e.isLoading,a=Object(r.useState)(""),c=Object(d.a)(a,2),i=c[0],o=c[1];Object(r.useEffect)((function(){var e=f();if(e)t(e),o(e);else{navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){var n=e.coords.latitude,r=e.coords.longitude;new Promise((function(e){return e(t({lat:n,lon:r}))})).then((function(e){return o(e.current.city.name)}))}),(function(e){console.error(e),o(v),t(v)}))}}),[t]);var s=Object(h.usePlacesWidget)({apiKey:"AIzaSyDemfiaMyVPyFJyDNSz_YJlH9GHb_efl8I",onPlaceSelected:function(e,n){var r=e.formatted_address;r&&(document.activeElement===n||t(r),b(r),o(r))},defaultValue:f()}).ref,u=function(e){var t=e.target.value;o(t),b(t.trim())};return Object(p.jsx)("div",{className:"control-row-container",children:Object(p.jsxs)("div",{className:"controls-row",children:[Object(p.jsx)("input",{placeholder:"City",className:"search-input",name:"city",value:i,onKeyDown:function(e){"Enter"===e.key&&(t(e.target.value),u(e))},onChange:u,ref:s}),Object(p.jsx)("button",{className:"search-button",disabled:n,onClick:function(){return t(i)},children:"Get weather"})]})})};n(29);var w=function(e){var t=e.weather,n=e.city,r=t.current,a=r.temp,c=r.humidity,i=r.feels_like,o="https://openweathermap.org/img/w/"+r.weather[0].icon+".png",s=j(a),u=j(i);return Object(p.jsxs)("div",{className:"weather-info-container",children:[Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{children:["City: ",n]}),Object(p.jsxs)("div",{children:["Temperature: ",s,"\xb0"]}),Object(p.jsxs)("div",{children:["Feels like: ",u,"\xb0"]}),Object(p.jsxs)("div",{children:["Humidity: ",c,"%"]})]}),Object(p.jsx)("img",{src:o,alt:""})]})};n(30);var m=function(e){var t=e.weather.daily;return Object(p.jsx)("div",{className:"weekly-weather-info",children:t.map((function(e,t){var n=e.humidity,r=e.temp,a=e.weather[0].icon,c=e.dt,i=j(r.min),o=j(r.max),s="https://openweathermap.org/img/w/"+a+".png",u=new Date(1e3*c).toGMTString(),l=u.slice(0,3),d=u.slice(5,11);return Object(p.jsxs)("div",{className:"daily-weather-info",children:[Object(p.jsx)("div",{children:l}),Object(p.jsx)("div",{children:d}),Object(p.jsx)("img",{src:s,alt:""}),Object(p.jsxs)("div",{children:[i,"\xb0 ... ",o,"\xb0"]}),Object(p.jsxs)("div",{children:["Humidity: ",n,"%"]})]},t)}))})};var x=function(e){var t=e.weather,n=e.error;if(e.isLoading)return Object(p.jsx)("div",{children:"Loading..."});if(n)return n.code&&404===n.code?Object(p.jsx)("div",{children:"City not found"}):Object(p.jsx)("div",{children:"Error has occured"});if(!t)return null;var r=t.current,a=t.forecast;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(w,{weather:a,city:r.city.name}),Object(p.jsx)(m,{weather:a})]})},y=n(7),g="GET_WEATHER_START",E="GET_WEATHER_SUCCESS",S="GET_WEATHER_ERROR",k="https://api.openweathermap.org/data/2.5",C=function(e){var t=e.lat,n=e.lon,r="".concat(k,"/forecast?lat=").concat(t,"&lon=").concat(n,"&appid=").concat("0ec977f31e9a39265aa9ff3b8a638ad3");return fetch(r)},T=function(e){var t="".concat(k,"/forecast?q=").concat(e,"&appid=").concat("0ec977f31e9a39265aa9ff3b8a638ad3");return fetch(t)},_=function(e){var t=e.lat,n=e.lon,r="".concat(k,"/onecall?appid=").concat("0ec977f31e9a39265aa9ff3b8a638ad3","&lat=").concat(t,"&lon=").concat(n);return fetch(r)};n(32);var L={searchWeather:function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r,a,c,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:g}),r=e instanceof Object?C:T,t.prev=3,t.next=6,r(e).then((function(e){return e.json()}));case 6:if("404"!==(a=t.sent).cod){t.next=9;break}throw{code:404};case 9:return c=a.city.coord,t.next=12,_(c).then((function(e){return e.json()}));case 12:return i=t.sent,n({type:E,payload:o={current:a,forecast:i}}),t.abrupt("return",o);case 18:t.prev=18,t.t0=t.catch(3),n({type:S,payload:t.t0}),console.error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[3,18]])})));return function(e){return t.apply(this,arguments)}}()}},N=Object(y.b)((function(e){return{weather:e.weather}}),L)((function(e){var t=e.weather,n=e.searchWeather,a=t.isLoading,c=Object(r.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.trim?t.trim():t)){e.next=5;break}return e.next=4,n(r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n]);return Object(p.jsxs)("div",{className:"weather-container",children:[Object(p.jsx)(O,{handleWeatherSearch:c,isLoading:a}),Object(p.jsx)(x,Object(o.a)({},t))]})})),R=n(4),W=n(14),H={isLoading:!1,error:null,weather:null};var G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,error:null});case E:return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,error:null,weather:t.payload});case S:return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,error:t.payload});default:return e}},A=Object(R.b)({weather:G}),I=[W.a],M=Object(R.c)(A,{},R.a.apply(void 0,I));var P=function(){return Object(p.jsx)(y.a,{store:M,children:Object(p.jsx)(N,{})})};n(33);i.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(P,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.a234ede7.chunk.js.map